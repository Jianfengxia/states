{#-
 Author: Bruno Clermont patate@fastmail.cn
 Maintainer: Bruno Clermont patate@fastmail.cn
 -#}
# {{ pillar['message_do_not_modify'] }}
# ubuntu upstart script for graylog2-server
{% set heap_size = pillar['graylog2']['heap_size']|default(False) %}
start on (filesystem and net-device-up IFACE=eth0)
stop on runlevel [!2345]

nice 10
respawn

script

  exec java{% if heap_size %} -Xms{{ heap_size }} -Xmx{{ heap_size }}{% endif %} -server -jar /usr/local/graylog2-server-{{ version }}/graylog2-server.jar --pidfile /var/run/graylog2.pid >> /var/log/graylog2/server.log
  emit graylog2-server_running
end script
