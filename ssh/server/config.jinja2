{#- Usage of this is governed by a license that can be found in doc/license.rst -#}

# {{ salt['pillar.get']('message_do_not_modify') }}
HostKey /etc/ssh/ssh_host_rsa_key
HostKey /etc/ssh/ssh_host_dsa_key

KexAlgorithms diffie-hellman-group-exchange-sha256
MACs hmac-sha2-512,hmac-sha2-256
Ciphers aes256-ctr,aes192-ctr,aes128-ctr

PubkeyAuthentication yes
PasswordAuthentication no

ServerKeyBits 768
# default values set by debian openssh-server
Protocol 2
ChallengeResponseAuthentication no
X11Forwarding yes
PrintMotd no
AcceptEnv LANG LC_*
Subsystem sftp /usr/lib/openssh/sftp-server
UsePAM yes
MaxAuthTries 3
# end of default values. here start overwrite:
{%- for port in salt['pillar.get']('ssh:server:ports', [22]) %}
Port {{ port }}
{%- endfor %}
{%- for cfg in salt['pillar.get']('ssh:server:extra_configs', []) %}
  {%- if not cfg.startswith('Port ') %}
{{ cfg }}
  {%- endif %}
{%- endfor %}
