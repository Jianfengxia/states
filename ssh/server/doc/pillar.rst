Pillar
======

.. include:: /doc/include/add_pillar.inc

- :doc:`/apt/doc/index` :doc:`/apt/doc/pillar`

Optional
--------

Example::

  ssh:
    server:
      host_keys:
        dsa: |
          -----BEGIN DSA PRIVATE KEY-----
          MIIBvAIBAAKBgQC8zTp4ZwvhRyNRlKENCG6mK5C42Y9gYOw+7b6jLOwnlO8TlPP0
          t9d4UzvIzDHyvxnklO729pAwOjsMs9neZeNrjYyE/4eZNFXZFEm0DlWC+UoVzM1U
          0fKSOcsqd4ImSaeOmqpRzz1QDQCdiRO16EJhmE54cJc6/6Q+pE4P3NAm0wIVALhr
          Ho/Lss7Qy/3yU6SPnNtT5lJVAoGAIq54MkxWHVti1XzURqvJrKPBBKOu2LXz9iZt
          zv7xwslWHCmuisJuWvntAqbdvfOWNNBydDEzul5sVyO4DyfTtxt+NtgYh1B1ncda
          wNcJ9iffLmbTJ0mLclhj10uaOWip8OM4c6LOqkvDLgELdORRWXne//VtvYGyRY2u
          9bB1oHwCgYEAjoVXCH25zEfJuRWzhGTuzCyjS0TQCRXMO7wNxAjCWraKb6vASWv5
          VhMw/VJirOAE61wapvfnOUBfoNZ8PJMaL63F3ibC7LQG3P30nss7nj6HhqRdKaSS
          QsWIXTMpIXOTm8VEsBWG3y+vYFmN2jrtrJc5+1xq23QdLE5RLmlnTKkCFQCApvho
          Vsrkajfbu9uamv/Apt5J2g==
          -----END DSA PRIVATE KEY-----
        rsa: |
          -----BEGIN RSA PRIVATE KEY-----
          MIIEowIBAAKCAQEAp5DVRRFkerwiTTO7ITycwqXWWKQkcGXVNVDeYQ4V5EYmwJIF
          HNx3kh2v7NIRh36HxIM81c7InL7w29h9tN0Dz569ARgK0SG9Kc+XS68za7/oQPd4
          tORXE5DIek9JVVR4TKHBZn/DsJws+VMfk8OpMtzVYBKYrOAfTQ/si9b0PQheCeyt
          mHmc8loeeS+LxE3poSUfOT1xXtMSUQ8Juc9gJTyCN9p8W/aAHMWtuWK4ztus6Dxw
          I77St4BswXjXwAeF2eWc8yMpVM9YDKQga2zYCyprWKZcsF9dwxzOZPoet7wzJgVk
          9QRxeW7DlH1D5HPtoVrLzNcKc+TX3LIpPnywUwIDAQABAoIBAQCTEgKt4UsQkmmE
          2x+mV127VfTgzgiRgj900SqtgsBiH9RJdp/4KeTkoRvUvrfV9Y9SQmG1ww2+zbP3
          MXd7s/RxWQDIogJ0dalitiozqm12Z/SAePQ/yJ5ItO3QtCBIPaBsmhh2TzNBooGy
          v2tatQOfecXp0cihCwFOEOjr/9lUasSRlMNE5f+xL3GDdpAXXl83G3yYMrhE8Qyu
          JaIC/ldpk5jXhvqWDxZBFZQc4QKt51dfgIioFFUqODSGGObmXHn8h5514n7xRp7D
          g8YXEYhmXsC+InhIvaDZ9xxqTK71xewisV3kNn9w9YwwpSyJi9UiLp5ca97SNRHW
          REAQ3UqJAoGBANpooTHEIeyALcJ1Kr1q+1jHn63QDn7ivWUXHT/N62hr6akgY1SK
          6S/Vzq7ZhGTtzqaMIQjSB8DiwV1B/xumampHtDLG6Nhr92mdd0PMrRerxD9F37Sg
          +C1unKrQh+kTLAlXKelz369VyNC0ZykY1h27dBUla1MqfNzynckJCX4dAoGBAMRn
          /zzR8ms4qaXuSnWIuScezeUSuJ9yqDC+XoGMXMM9LO+2l1ZCBrP/+G2EfT/zLqyY
          7bxdz88lYTVhMlEbkf0aQus1sJp+9T4VzAPiMJs7tsRCpkyUBVqspfVC3NkVLirG
          iFf1tetCogykpcx4ruvjMkblZegr1S//v7mTRl0vAoGAVqeAnRAmLYFFpot6I6EY
          jEbXkcykk68+WadsEW6P4eQ+1r1k65wZnMMFt9XRc4HupaGfUbKTJPJSqb+Pidbj
          DbvZQPQuWf+sMBkrwpiobGXX/QqqES50iQID4rnN0qmqpSISHO++ZgBxJm0NKP8T
          pMRE8EbiaCLJW5hfBe4x9/kCgYAad+ltyN1ilcBHHFXsgQByxTP6Kwu2cT05VG5o
          BwJ5TUVBCNpcRYmhuF1CZRh8BcnEeNeRCxN2VxNCnlapl42VDnT2PcYPDA0A0O8t
          ls32HZYD3PeMWmZeUeYLp3cbyj7uhNLbB8H8cn5kNcwiQiFQqM2dwEx7fWy9iznL
          SI2zAQKBgEUVLOeYUSjMt1TdjgRJYxpFe37WZaj039doKjH0zYFbi9rRaIE/3/7B
          ystJTpTR2tcGMVd2lYXnvhaWfS9sAemt5RB3vpGM00yqVfIbH5+GHqWu/RIGShEQ
          rbLR4iHtE7Q1H1hv1J7ahhRWWU/cjEanACjFqZXTcX88CSy7LAZw
          -----END RSA PRIVATE KEY-----
      root_keys:
        santos:
          - ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDB+hcS+d/V0cmEDX9zv07jXcH+b5DB4YD9ptx0kVtpfkQWc+TtYH/eY2jmTXUZWVx+kfn5qDI3Ojq9jRgfgM0tuICqTW78Vi2P4Qd5ektFkkAa9ERhhZRMzi0tbpQdyOQxEkflh3Upmuwm+im9Y4TdWNvVO3cM+DOCH1JNpEgh5OGo52/Tq/FUgzt750Ls1/QPzbmkgUYd9SmEknrS/dHm9XRm5D0RumQzW75CniuyZEx+Gn/C/+h+mHapBCXizUZEK9+y7er9MOmHTZ5Er9tb/bc6k7cQYXVzIGqLm8ENV1SYeSwxuTsPrvTsBGHqURBAnz3OllQD2yws5XmmIJ2L
      ports:
        - 22
        - 22022
      extra_configs:
        - RhostsRSAAuthentication no
        - HostbasedAuthentication no
        - RSAAuthentication yes
        - PubkeyAuthentication yes
        - KeyRegenerationInterval 3600
        - SyslogFacility AUTH
        - LogLevel INFO
        - LoginGraceTime 120
        - PermitRootLogin yes
        - StrictModes yes
        - IgnoreRhosts yes
        - PermitEmptyPasswords no
        - X11Forwarding no
        - X11DisplayOffset 10
        - PrintLastLog yes
        - TCPKeepAlive yes

.. _pillar-ssh-server-host_keys:

ssh:server:host_keys
~~~~~~~~~~~~~~~~~~~~

Data formed as a dictionary with key is the host key type and value is the
content of that key.

Default: do not manage those keys (``{}``).

.. _pillar-ssh-server-ports:

ssh:server:ports
~~~~~~~~~~~~~~~~

List of SSH port that :doc:`index` listens on.

Default: Port ``[22]``

.. _pillar-ssh-server-extra_configs:

ssh:server:extra_configs
~~~~~~~~~~~~~~~~~~~~~~~~

List extra configurations for :doc:`index`.

See more in
`SSH man <http://www.openbsd.org/cgi-bin/man.cgi?query=sshd_config&sektion=5>`_.

Default: No extra configs will be used (``[]``).

.. warning::

  Some formula such as :doc:`/git/server/doc/index`, :doc:`/gitlab/doc/index`
  and :doc:`/salt/archive/doc/index` requires some users allowed to log in.

.. _pillar-ssh-server-root_keys:

ssh:server:root_keys
~~~~~~~~~~~~~~~~~~~~

SSH public keys to allow login with root user.

Structure::

  root_keys:
    human name:
      ssh public key: type
      another ssh public key: another type

Default: do not allow to login by any public key (``{}``).

.. _pillar-root_keys-user:

ssh:server:root_keys:{{ user }}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Data formed as a list of public ssh keys.

Default: ``[]``.

Conditional
-----------

.. _pillar-ssh-server-host_keys-type:

ssh:server:host_keys:{{ type }}
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:doc:`index` host keys that will be stored in ``/etc/ssh/ssh_host_*``. It can
be generated by using::

  ssh-keygen -t {{ type }} -N "" -f /etc/ssh/ssh_host_{{ type }}_key
