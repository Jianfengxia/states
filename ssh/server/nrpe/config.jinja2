{#-
Use of this source code is governed by a BSD license that can be found
in the doc/license.rst file.

-#}
{%- set timeout = 15 -%}
ssh_procs:
  description: SSH Server Daemon
  command: '/usr/lib/nagios/plugins/check_procs -c 1:1 -C sshd -u root -a /usr/sbin/sshd'

{#- check only one port to see if ssh daemon works, no need to check all ports #}
ssh_port:
  description: SSH Server Local Port
  command: "/usr/lib/nagios/plugins/check_tcp -H 127.0.0.1 -p {{ salt['pillar.get']('ssh:server:ports', [22])[0] }} -t {{ timeout }}"
  timeout: {{ timeout }}
  dependencies:
    - ssh_procs
