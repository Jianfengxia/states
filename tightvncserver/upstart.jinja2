#!/bin/bash
# {{ pillar['message_do_not_modify'] }}

export HOME="{{ home }}"
export USER="{{ user }}"

rm -rf /tmp/.X1*
. /lib/lsb/init-functions

case "$1" in
start)
log_action_begin_msg "Starting vncserver"
su {{ user }} -c "/usr/bin/vncserver -depth 16 -geometry {{ salt['pillar.get']('tightvncserver:resolution', '1024x768') }} :1 "
;;

stop)
log_action_begin_msg "Stoping vncserver"
su {{ user }} -c "usr/bin/vncserver -kill :1"
;;

restart)
$0 stop
$0 start
;;
esac
exit 0
