# {{ pillar['message_do_not_modify'] }}
{%- set instances_count = pillar['graphite']['carbon']['instances'] %}
command[carbon_relay_procs]=/usr/lib/nagios/plugins/check_procs -c 1:1 -u graphite -C python -a "/usr/local/graphite/bin/carbon-relay.py --config=/etc/graphite/carbon.conf start"
command[carbon_cache_procs]=/usr/lib/nagios/plugins/check_procs -c {{ instances_count }}:{{ instances_count }} -u graphite -C python  -a "/usr/local/graphite/bin/carbon-cache.py --config=/etc/graphite/carbon.conf"
{% for instance in range(instances_count) %}
command[carbon_cache_{{ instance }}_procs]=/usr/lib/nagios/plugins/check_procs -c 1:1 -u graphite -C python -a "/usr/local/graphite/bin/carbon-cache.py --config=/etc/graphite/carbon.conf --instance={{ instance }} start"
command[carbon_cache_{{ instance }}_port_plaintext]=/usr/lib/nagios/plugins/check_tcp -H 127.0.0.1 -p 20{{ instance|int + 1 }}3
command[carbon_cache_{{ instance }}_port_pickle]=/usr/lib/nagios/plugins/check_tcp -H 127.0.0.1 -p 20{{ instance|int + 1 }}4
command[carbon_cache_{{ instance }}_port_cache_query]=/usr/lib/nagios/plugins/check_tcp -H 127.0.0.1 -p 70{{ instance|int + 1 }}2
{% endfor %}
command[carbon_port_plaintext]=/usr/lib/nagios/plugins/check_tcp -H 127.0.0.1 -p 2003
command[carbon_port_pickle]=/usr/lib/nagios/plugins/check_tcp -H 127.0.0.1 -p 2004
