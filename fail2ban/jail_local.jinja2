{#-
Use of this source code is governed by a BSD license that can be found
in the doc/license.rst file.

Author: Quan Tong Anh <quanta@robotinfra.com>
Maintainer: Quan Tong Anh <quanta@robotinfra.com>
-#}
# {{ pillar['message_do_not_modify'] }}

[ssh]

enabled  = true
port     = {% for port in salt['pillar.get']('ssh:server:ports', [22]) %}{{ port }}{% if not loop.last %},{% endif %}{% endfor %}
filter   = sshd
logpath  = /var/log/auth.log
maxretry = {{ salt['pillar.get']('fail2ban:maxretry', 3) }}

{%- if accumulator|default(False) %}
  {% for line in accumulator['filters'] %}
{{ line }}
  {% endfor %}
{%- endif %}
