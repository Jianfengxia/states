{%- set rabbitmq_checks = {'rabbitmq_procs': 'Daemon', 'rabbitmq_port_management': 'Management Port', 'rabbitmq_port_console': 'Console Port', 'rabbitmq_port_amqp': 'Local AMQP Port', 'erlang_procs': 'Erlang', 'erlang_port': 'Erlang Port'} -%}
{%- for check in rabbitmq_checks %}
{{ check }}:
  description: RabbitMQ {{ rabbitmq_checks[check] }}
  check: check_nrpe!{{ check }}

{% endfor -%}

{%- set deployment = 'rabbitmq' %}
{%- set nginx_instances_checks = {'http': 'HTTP protocol', 'https': 'HTTPs Protocol', 'https_certificate': 'HTTPs Certificate Expiration'} -%}
{%- for check in nginx_instances_checks %}
{{ deployment }}_nginx_{{ check }}:
  description: {{ deployment|capitalize }} {{ nginx_instances_checks[check] }}
  check: check_nrpe!{{ deployment }}_nginx_{{ check }}
{%- if check == 'https_certificate' %}
  check_interval: 1440 {#- only need to check https certificate each day -#}
{%- endif %}
{% endfor -%}

rabbitmq-remote-amqp-port:
  description: Remote RabbitMQ AMQP Port
  check: check_tcp!55672
