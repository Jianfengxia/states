{#-
 Author: Bruno Clermont patate@fastmail.cn
 Maintainer: Bruno Clermont patate@fastmail.cn
 -#}
# {{ pillar['message_do_not_modify'] }}
# memcached upstart script

start on (filesystem and net-device-up IFACE=lo)
stop on runlevel [!2345]

respawn
respawn limit 10 5
{%- if salt['pillar.get']('memcache:memory', False) %}
exec /usr/bin/memcached -m {{ pillar['memcache']['memory'] }} -s /tmp/memcached.sock -p 11211 -u www-data -l 127.0.0.1
{%- else %}
exec /usr/bin/memcached -s /tmp/memcached.sock -p 11211 -u www-data -l 127.0.0.1
{%- endif %}
