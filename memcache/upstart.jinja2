{#-
Use of this source code is governed by a BSD license that can be found
in the doc/license.rst file.

Author: Bruno Clermont <bruno@robotinfra.com>
Maintainer: Viet Hung Nguyen <hvn@robotinfra.com>
-#}
# {{ salt['pillar.get']('message_do_not_modify') }}
# memcached upstart script

start on (filesystem and net-device-up IFACE=lo)
stop on runlevel [!2345]

respawn
respawn limit 10 5
{%- if salt['pillar.get']('memcache:memory', 64) %}
exec /usr/bin/memcached -m {{ salt['pillar.get']('memcache:memory', 64) }} -s /tmp/memcached.sock -u www-data
{%- else %}
exec /usr/bin/memcached -s /tmp/memcached.sock -u www-data
{%- endif %}
